# 远程数据采集系统

<!---------------------------------->
---
## 主要技术介绍硬件+协议

### MQTT

背景，特性，原理（每个字节的意义）

### AMQP

背景，特性，传输流
## 环境数据感知层开发

### 硬件介绍

#### IAP15W4K58S4

<!--介绍 + 参数 + 开发方案(所需语言/SDK/配置方法等) -->
<!--对于单片机，应该介绍的有：UART 看门狗，计时器 -->

#### ESP8266
<!-- 介绍加具体参数 -->
<!-- 这里纠结的点在于，如果我把初始化，发送SSID和Password，Station，单链接，透传模式都说了，下面的软件设计就不知道该说什么-->

#### 其他辅助硬件

<!-- OLED 按键 电源 -->

### 硬件接口连线

<!-- 主要应该放电路图和接口连接表，但是我不知道这里应该说些什么-->

### 软件设计

#### 软件总体结构
<!-- 代码的总体结构图（模块构成方案，文件结构层次），流程图（大体上的，详细的分列在下面不同的模块中，这里对看门狗的画法有待商榷）-->
在环境数据感知层需要完成一系列对于硬件的控制及数据的传输，需要一些配套的模块去实现这些功能。为在开发过程中实时的获得代码运行情况，需要实现单片机与上位机之间的串口通信功能；为通过WiFi将数据上传至物联网平台，需完成对ESP8266的配置功能；为获取传感器数据，需完成对传感器数据的获取与解析功能；为便于在现场查看传感器数据，需完成对OLED的控制功能。同时，在这些功能实现的过程中，考虑到单片机的性能问题及外围硬件的速度问题，需要实现延时功能去保证代码正常运行；考虑到异常情况下单片机宕机问题，需要看门狗功能保证宕机后硬件能够重启恢复至正常运行。程序运行时流程图如图所示：
<!--这里放置代码的流程图 -->

#### 延时方案

##### 循环延时

<!-- 两段，软件延时（for循环）和硬件延时（计时器，主要说一下看门狗的作用）-->
为保证代码的正常运行，适应硬件的速度以及串口消息发送速率，需要引入延时函数对代码的运行速度进行控制。考量到在延时的过程中需要让代码暂停运行，因此利用for循环占用CPU即可。为便于使用，延时函数需要的控制参数为延时的毫秒数，

##### 看门狗

原理（具体到每一位的作用）+ 流程图

#### 调试方案

串口打印数据调试，这里写调试的意义，引出来利用串口进行调试

##### 串口初始化

对于代码的介绍，按照以下规则来写：原理（所需的软件或者硬件，比如说计时器；输入的参数以及输出结果的格式和意义） + 流程（配图）+ 输出的结果

##### 串口发送数据

和上面一样，介绍锁写的几个模块 + 流程图

##### 预期结果

包括如何使用本小节中的这些模块，如何在电脑端进行配置，如何算是成功，外加一个成功的截图

#### 传感器数据采集

这个和上面的不同，这个就一节，反正就是个采集按键信息

原理 + 流程图

#### ESP8266

##### 初始化

##### 模式控制 

##### 数据发送
这里不仅要说CIPSEND，也要说根据MQTT协议对数据的包装

##### 预期结果

#### OLED

##### 配置

##### 预期结果

### 小结

#### 烧录

#### 预期运行结果

## 用户层开发

### 总体架构方案
这里包括总体的架构图，数据流向图，但我没想好怎么介绍

### AMQP客户端
对于AMQP客户端的选择与介绍放在这里

#### 第三方库配置

#### 代码结构

#### 预期结果

### Spring boot及MySQL数据库
对Spring和MySQL的介绍放在这里

#### 总体结构

#### xml文件配置

#### 与数据库的连接
详细方面的介绍要包括，注解，CURD，Page，自定义SQL语句，auto主键，时间戳

#### AMQP客户端的引入

#### 界面设计

#### 预期结果

### 小结

## 引用和致谢














